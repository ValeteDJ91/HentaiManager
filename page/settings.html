<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title id="title">Hentai manager</title>
    <meta http-equiv="Content-Security-Policy" content="script-src 'self' 'unsafe-inline';" />
    <link href="../css/stylesheets.css" rel="stylesheet">
</head>
<style>

</style>
<body>
    <div class="area"></div><nav class="main-menu" style="position:fixed">
        <ul>
            <li>
                <i class="fa fa-2x"><img style="height: 35px" src="../img/icon.ico"></i>
                <span class="nav-text" style="color: #ffffff;">
                    HentaiManager
                </span>
            </li>
            <li>
                <a href="../index.html">
                    <i class="fa fa-2x"><img style="height: 35px;margin-top: 5px;" src="../img/dashboard.png"></i>
                    <span class="nav-text">
                        Dashboard
                    </span>
                </a>
            </li>
            <li class="has-subnav">
                <a href="image.html">
                    <i class="fa fa-2x"><img style="height: 35px;margin-top: 5px;" src="../img/image.png"></i>
                    <span class="nav-text">
                        Image
                    </span>
                </a>
            </li>
            <li class="has-subnav">
                <a href="doujinshi.html">
                    <i class="fa fa-2x"><img style="height: 35px;margin-top: 5px;" src="../img/doujinshi.png"></i>
                    <span class="nav-text">
                        Doujinshi
                    </span>
                </a>
            </li>
        </ul>

        <ul class="logout">
            <li>
               <a href="settings.html">
                    <i class="fa fa-2x"><img style="height: 35px;margin-top: 5px;" src="../img/settings.png"></i>
                    <span class="nav-text">
                        Settings
                    </span>
                </a>
            </li>  
        </ul>
    </nav>
    <div id="main" style="margin-left: 75px;margin-top: 15px;margin-right: 15px;">
        <h2>General</h2><hr>
        <h2>Image</h2><hr>
        <div style="margin-left:25px;margin-top: 13px">
            <div>
                <label for="imgfoldloc" style="color:#ffffff;">Image folder location:  </label>
                <input id="imgfoldloc" value="" style="color:#000000;width: 300px;height: 17px;">
            </div>
            <div style="margin-top: 13px;">
                <a style="color:#ffffff">Image default size: </a>
                <input type="range" min="1" max="6" value="3" class="slider" id="sizeslider" style="vertical-align: middle">
                <a id="slidervaluetext" style="color:#ffffff"></a>
            </div>
            <div>
                <label for="imgloadfirst" style="color:#ffffff;">How many image will load:  </label>
                <input id="imgloadfirst" value="" style="color:#000000;width: 300px;height: 17px;">
                <a style="color:#ffffff">(the higher it is the longer the page will take to load)</a>
            </div>
            <div>
                <label for="imgloadscroll" style="color:#ffffff;">How many image will load after scrolling (infinite scroll):  </label>
                <input id="imgloadscroll" value="" style="color:#000000;width: 300px;height: 17px;">
                <a style="color:#ffffff">(if it s too high you might have to wait before scrolling more)</a>
            </div>
        </div>
        <h2>Doujinshi</h2><hr>
        <div style="margin-left:25px;margin-top: 13px">
            <div>
                <label for="doujinshifoldloc" style="color:#ffffff;">Doujinshi folder location: </label>
                <input id="doujinshifoldloc" value="" style="color:#000000;width: 300px;height: 17px;">
            </div>
        </div>
        <a style="color:#199c0d;font-size:20px;" id="saved"></a>
    </div>
</body>
</html>

<script>
const fs = require('fs')

var jsoninput = fs.readFileSync('data/settings.json', 'utf8')
var settings = JSON.parse(jsoninput)
var slidervaluetext = ["HOW", "tiny", "small", "normal", "big", "huge", "just click on it at this point"];
var imgfoldloc = document.getElementById("imgfoldloc");
var sizeslider = document.getElementById("sizeslider");
var imgloadfirst = document.getElementById("imgloadfirst");
var imgloadscroll = document.getElementById("imgloadscroll");
var doujinshifoldloc = document.getElementById("doujinshifoldloc");

// img folder location
if (settings.image.folder) {imgfoldloc.setAttribute('value',settings.image.folder)}
imgfoldloc.addEventListener('change', (updateValue) => {
    settings.image.folder = event.target.value
    savesettings()
});

// feault img size
document.getElementById("slidervaluetext").innerHTML = slidervaluetext[sizeslider.value]
if (settings.image.imgsize) {sizeslider.setAttribute('value',settings.image.imgsize)}
sizeslider.oninput = function() {
    settings.image.imgsize = sizeslider.value
    savesettings()
    document.getElementById("slidervaluetext").innerHTML = slidervaluetext[sizeslider.value]
}

// img first load
if (settings.image.imgloadfirst) {imgloadfirst.setAttribute('value',settings.image.imgloadfirst)}
imgloadfirst.addEventListener('change', (updateValue) => {
    settings.image.imgloadfirst = event.target.value
    savesettings()
});

// img load on scrolling
if (settings.image.imgloadscroll) {imgloadscroll.setAttribute('value',settings.image.imgloadscroll)}
imgloadscroll.addEventListener('change', (updateValue) => {
    settings.image.imgloadscroll = event.target.value
    savesettings()
});

// doujinshi folder location
if (settings.doujinshi.folder) {doujinshifoldloc.setAttribute('value',settings.doujinshi.folder)}
doujinshifoldloc.addEventListener('change', (updateValue) => {
    settings.doujinshi.folder = event.target.value
    savesettings()
});

// save changes
function savesettings(){
    var jsonoutput = JSON.stringify(settings)
    fs.writeFile('data/settings.json', jsonoutput, function (err) {
        if (err) throw err;
    });
    document.getElementById("saved").innerHTML = "Settings saved!"
}

document.getElementById("title").innerHTML = settings.version

</script>